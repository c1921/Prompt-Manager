<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SD Prompt Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .network-status {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ccc;
        }
        
        .status-indicator.available {
            background-color: #4CAF50;
        }
        
        .status-indicator.unavailable {
            background-color: #f44336;
        }
    </style>
</head>
<body>
    <div class="network-status">
        <div class="status-indicator"></div>
        <span class="status-text">检查翻译服务...</span>
    </div>
    <h1>SD Prompt Manager</h1>
    <form class="prompt-form" method="POST" onsubmit="updatePromptInput()">
        <textarea 
            class="prompt-input" 
            name="prompt" 
            placeholder="请输入您的提示词..."
            oninput="splitIntoBlocks(this.value)"
        >{{ prompt if prompt else '' }}</textarea>
        <button type="button" class="translate-all-button" onclick="translateAllPrompts()">整体翻译</button>
        <div class="prompt-blocks" id="blockContainer"></div>
    </form>

    <script src="{{ url_for('static', filename='js/prompt-manager.js') }}"></script>
    <script>
        // 定期检查网络状态
        function checkNetworkStatus() {
            fetch('/check-network')
                .then(response => response.json())
                .then(data => {
                    const indicator = document.querySelector('.status-indicator');
                    const statusText = document.querySelector('.status-text');
                    
                    if (data.status === 'available') {
                        indicator.className = 'status-indicator available';
                        statusText.textContent = '翻译服务可用';
                    } else {
                        indicator.className = 'status-indicator unavailable';
                        statusText.textContent = '翻译服务不可用';
                    }
                })
                .catch(() => {
                    const indicator = document.querySelector('.status-indicator');
                    const statusText = document.querySelector('.status-text');
                    indicator.className = 'status-indicator unavailable';
                    statusText.textContent = '检查失败';
                });
        }

        // 页面加载时检查
        checkNetworkStatus();
        // 每30秒检查一次
        setInterval(checkNetworkStatus, 30000);
    </script>
</body>
</html> 